<%@LANGUAGE="VBSCRIPT" CODEPAGE="1251" LCID=1049 %>
<%
Session.lcid=1049
Session.codepage=1251
SetLocale("ru-RU")
%>

<style type="text/css">
<!--
.red {
	font-weight: bold;
	color: #FF0000;
}
-->
</style>

<!--#include virtual="\lib\mainlib.asp" -->
<!--#include virtual="\lib\FormLib.asp" -->

<% '[webform_version]
Set DB = GetDataBase()
Set sp[table_name] = StoredProc(DB,"dbo.sp[table_name]")

<FL Types="L">
Set sp{5}_{0} = StoredProc(DB,"dbo.sp{6}")
Set sp{5}_{0}("@Mode")=3 ' Select mode
Set sp{5}_{0}("@SubMode")=3 ' SelectName submode (fill values list)
Set sp{5}_{0}("@{6}")=IIF(Len(Request("{0}"))>0,Request("{0}"), NULL) ' ERR!!! Add form name! Unlock probably deleted record
Set {5}_{0}_List = ExecCursor(Set sp{6}_{5})
</FL>
set Form = new AspForm
Form.Name = "Form"

<FL Types="PF">
Set Element = New FormControl
with Element
	.AssignField [table_name]("@{0}"), "{0}"
	.MakeHidden Form.Name & "_{0}", ""
	Form.AddToGroup Element,"H0"
end with
</FL><FL Types="pl">
Set Element = New FormControl
with Element
	.AssignField [table_name]("@{0}"), "{0}"
	.Label = "{1}"
	.MakeText Form.Name & "_{0}", ""
	.Options("size") = "{9}"
	.Options("class") = "user_input"
	Form.AddToGroup Element,"C0"
	.Required = True
	.AddRequiredValidator "You must specify " & .Label
	.AddMaxLenValidator {9}, "Length of text should not exceed {9} symbols"
end with
</FL><FL Types="L">
Set Element = New FormControl
with Element
	.AssignFieldNull [table_name]("@{6}"), -3, "{6}"
	.Label = "{1}"
	.MakeSelect Form.Name & "_{6}", "-3"
	.AddSelectOption "Chose One",  "-1"
	.AddSelectOption "---------------",  "-2"
	.AddSelectOption "- Empty -",  "-3"
	.FillSOFromRowset {5}_{0}_List ,"SelectName","{6}"
	.AddNotEqualValidator -1,"You must choose " & .Label
	.AddNotEqualValidator -2,"You must choose " & .Label
	.Options("class") = "user_input"
	Form.AddToGroup Element,"C0"
end with
</FL>
Set Element = New FormControl
with Element
	.MakeSubmit  Form.Name & "_Submit", "Save"
	.Options("class") = "user_input"
	Form.AddControl(Element)
end with

Set Element = New FormControl
with Element
	.MakeSubmit  Form.Name & "_Delete", "Delete"
	.Options("class") = "user_input"
	.Options("onClick") = "return window.confirm('Are you sure ?');"
	Form.AddControl(Element)
end with

Set Element = New FormControl
with Element
	.MakeSubmit  Form.Name & "_Copy", "Save as New copy"
	.Options("class") = "user_input"
	.Options("onClick") = "return window.confirm('Are you sure ?');"
	Form.AddControl(Element)
end with

<FL Types="L">
{5}_{0}_List.Close
Set {5}_{0}_List_List = nothing
Set sp{5}_{0} = nothing
</FL>
